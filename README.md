# 健康体检报告生成器

基于 `员工表.xlsx`、`data/` 目录下的体检原始资料，以及 `2025员工体检报告（模板）.pptx` 的整体样式（配色 + 版式 + 纵横比），自动为 **每位员工** 输出独立的体检报告 PPT。

## 数据约定

- `员工表.xlsx`：首行为表头，至少包含 `姓名`、`证件号` 两列，其余列会原样保留在内存，可按需扩展。
- `data/`：存放每位员工的检查文件。命名规范：
  - 所有文件：`姓名-证件号-类型.扩展名`（如 `王磊-12022519860808003X-血检.pdf`、`王磊-12022519860808003X-总结.docx`）
- 模板：`2025员工体检报告（模板）.pptx`，用于提取企业统一的配色/字体，并同步模板的页面尺寸（如竖版 A4）。

## 快速开始

```bash
npm install
npm start
```

生成的 PPT 会输出到 `output/员工体检报告_姓名_HHMM.pptx`，每位员工一份。若员工既没有任何检查文件，也没有 AI 总结，则跳过生成并给出原因统计。

## 生成内容

对每位员工依次生成以下内容：

1. **封面**：姓名、证件号、文件统计、AI 总结概览。
2. **影像幻灯片**：嵌入所有图片类检查；PDF 检查会自动转成多页图片插入。文件按照以下顺序处理：
   - inbody
   - 尿检
   - 血检
   - 心电图
   - 生化检查
   - AI解读
3. **AI 总结详情**：从 Word 文档抽取的段落，自动分段排版。

## 实现要点

- 使用 `ExcelJS` 解析员工表，支持 500+ 员工顺序处理。
- 通过 `mammoth` 抽取 AI 总结 Word 文本，自动断句与分段。
- 利用 `PptxGenJS` 绘制幻灯片，并在运行时读取模板的实际页面尺寸/方向，保持版式（如竖版 A4）一致。
- 通过 `pdf2pic` 将 PDF 检查转成图片后纳入 PPT，若转换失败会在日志中提示。
- 影像页统一采用“contain”策略插入图片，自动保留宽高比，不会被拉伸或裁切。
- 目录/文件缺失或员工无可用数据时会给出控制台告警，便于补充资料后再次生成。
- 支持根据"姓名+证件号"精准匹配员工和体检结果文件，避免同名员工信息混淆。
- 生成的文件名简洁易读，重名员工会自动添加数字后缀（如 `员工体检报告_王磊_1_HHMM.pptx`）。
