# 健康体检报告生成器

基于 `员工表.xlsx`、`data/` 目录下的体检原始资料，以及 `2025员工体检报告（模板）.pptx` 的主题色，自动为 **每位员工** 输出独立的体检报告 PPT，并在文件名中包含 “姓名-工号”。

## 数据约定

- `员工表.xlsx`：首行为表头，至少包含 `姓名`、`工号` 两列，其余列会原样保留在内存，可按需扩展。
- `data/`：存放每位员工的检查文件。命名规范：
  - AI 总结：`姓名_总结.docx`
  - 其他检查：`姓名-类型.扩展名`（如 `王磊-血检.pdf`、`王磊-B超.jpg`）
- 模板：`2025员工体检报告（模板）.pptx`，用于提取企业统一的配色/字体风格。

## 快速开始

```bash
npm install
npm run generate
```

生成的 PPT 会输出到 `output/员工体检报告_姓名_工号_YYYYMMDD_HHMM.pptx`，每位员工一份。若员工既没有任何检查文件，也没有 AI 总结，则跳过生成并给出原因统计。

> ⚠️ PDF 转图片依赖本地已安装 **GraphicsMagick** 与 **Ghostscript**。若尚未安装，可参考 `node_modules/pdf2pic/docs/gm-installation.md`。

## 生成内容

对每位员工依次生成以下内容：

1. **封面**：姓名、工号、文件统计、AI 总结概览。
2. **检查项表格**：列出所有上传的检查文件。
3. **AI 总结详情**：从 Word 文档抽取的段落，自动分段排版。
4. **影像幻灯片**：嵌入所有图片类检查；PDF 检查会自动转成多页图片插入。
5. **其他附件列表**：PDF/其它文档的清单，指引查看原文件路径。

## 实现要点

- 使用 `ExcelJS` 解析员工表，支持 500+ 员工顺序处理。
- 通过 `mammoth` 抽取 AI 总结 Word 文本，自动断句与分段。
- 利用 `PptxGenJS` 绘制幻灯片，自动套用模板的主题色。
- 通过 `pdf2pic` 将 PDF 检查转成图片后纳入 PPT，若转换失败会在日志中提示。
- 目录/文件缺失或员工无可用数据时会给出控制台告警，便于补充资料后再次生成。

## 常见问题

- **没有 AI 总结**：对应幻灯片会提示“暂无AI总结，请补充”，只要有检查文件仍会生成 PPT。
- **完全没有资料**：脚本会跳过该员工并在日志中列出原因，方便回头补齐。
- **PDF 转换失败**：请检查是否已安装 GraphicsMagick/Ghostscript 或 PDF 是否加密，脚本会继续生成其它内容。
- **模板/数据重命名**：请保持与上述路径一致，或调整 `src/index.js` 中的常量。

